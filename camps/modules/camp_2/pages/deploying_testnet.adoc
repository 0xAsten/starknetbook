[id="deploying_testnet"]

= Deploying to the testnet

For the devnet, we used the help of Protostar's profiles, so we do not have to write the whole chain Id and gateway URL; at the beginning of each command, we added `-p devnet`, e.g. `protostar -p devnet deploy`. We could write a profile in our Protostar configuration for the testnet too. However, for didactic purposes and because it is more straightforward, we will not create a profile for the testnet.

In order to sign our transactions (remember we need an account contract) on the testnet we can proceed in different ways:

. Use an account linked to a Braavos or Argent wallet.
. Deploy and use an account contract using starknet's CLI. It will be really similar to Open Zeppelin's standard. We would need to employ counterfactul deployment as we saw in Camp 1.
. Deploy and use a customized account contract. We will review this in Camp 3.

Let us use here option 1. We can use the UI of either our Argent or Braavos wallet; I will show how to do it with Braavos here. Go to the "Privacy & Security" option.

image::braavos2.png[braavos2]

We export the private key and add it to the environmental variables with `export PROTOSTAR_ACCOUNT_PRIVATE_KEY=[THE EXPORTED PRIVATE KEY]`.

Then we `declare` our contract adding to the `--account-address` flag the address of our wallet.

[,Bash]
----
protostar declare build/vote.json \
    --account-address 0x06dcb489c1a93069f469746ef35312d6a3b9e56ccad7f21f0b69eb799d6d2821 \
    --max-fee auto \
    --network testnet
----

We get:

[,Bash]
----
Declare transaction was sent.
Class hash: 0x02bebbf6d9e8cf11a1d0e04226e68f8d73ddfb025fb058c769fc6b48b27e57cf
StarkScan https://testnet.starkscan.co/class/0x02bebbf6d9e8cf11a1d0e04226e68f8d73ddfb025fb058c769fc6b48b27e57cf

Transaction hash: 0x05b6fa2f6019ee0f2053091b3d1965fb7de6422e85ca9db33b317caf5d7f626e
StarkScan https://testnet.starkscan.co/tx/0x05b6fa2f6019ee0f2053091b3d1965fb7de6422e85ca9db33b317caf5d7f626e
----

Before sending another transaction to the network, ensure the previous transaction (declare) is at least in the "`Pending`" state; otherwise, the second transaction will fail due to an incorrect nonce value. This happens because the network tracks the current nonce value of each user account, and this value is updated only after a transaction has entered the Pending state.

Now that we have the class hash, we can deploy. Similar to the devnet, let us use real values. As account addresses we could use (1) accounts generated by the Argent or Braavos wallets, or (2) addresses we create using the starknet CLI or Protostar. We will use both options.

In Camp 1 we deployed an account with the Alias `voting-contract`. It has the address `0x00f20c6664cc47e569abe53c7ba19f04685158a1b2f01c9a923cd3849354a928`; the private key is automatically stored in `~/.starknet_accounts/starknet_open_zeppelin_accounts.json`. We will add this account as one of the contracts allowed to vote and deploy from a Braavos account (however, feel free to use any account you want). Remember to export the private keys of the account to your environmental variables, e.g., `+export PROTOSTAR_ACCOUNT_PRIVATE_KEY=0x03a...+`.

[,Bash]
----
protostar deploy 0x02bebbf6d9e8cf11a1d0e04226e68f8d73ddfb025fb058c769fc6b48b27e57cf \
    --account-address 0x06dcb489c1a93069f469746ef35312d6a3b9e56ccad7f21f0b69eb799d6d2821 \
    --max-fee auto \
    --network testnet \
    --inputs \
        0x06dcb489c1a93069f469746ef35312d6a3b9e56ccad7f21f0b69eb799d6d2821 \
        2 \
        0x00f20c6664cc47e569abe53c7ba19f04685158a1b2f01c9a923cd3849354a928 \
        0x02cdAb749380950e7a7c0deFf5ea8eDD716fEb3a2952aDd4E5659655077B8510
----

We get:

[,Bash]
----
Invoke transaction was sent to the Universal Deployer Contract.
Contract address: 0x03f1d3126c08ca82021abf265205c4c00ea80cde386781c1df8e190990962ebc
StarkScan https://testnet.starkscan.co/contract/0x03f1d3126c08ca82021abf265205c4c00ea80cde386781c1df8e190990962ebc

Transaction hash: 3486627275562620503680140120664986229453108046815711293106888485118594079697
StarkScan https://testnet.starkscan.co/tx/0x07b55c715b519ba20479e1bb94d48d00cd6d402f474b7cc3ccc2a45d658d5bd1
----

Again, Protostar deployed using the UDC in the background. Remember, since we are deploying to the testnet, it might take some minutes for the transaction to pass.

Great. We deployed our voting contract to both the devnet and the tesnet. This allows us to interact with our contract in a block explorer, with the CLI, or other tools.
